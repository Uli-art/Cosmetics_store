@{
    ViewBag.Title = "Index";
    var request = ViewContext.HttpContext.Request;
    var returnUrl = request.Path + request.QueryString.ToUriComponent();
    var req = ViewContext.HttpContext.Request;
    string? category = req.RouteValues["category"]?.ToString();
}
@model CosmeticsShop.Domain.Models.ProductListModel<CosmeticsShop.Domain.Entities.Cosmetics>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Index</title>
</head>
<body>
    <div class="row">
        <div class="col-sm-2">
            <div class="border-2">
                <ul class="nav ">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle"
                           data-bs-toggle="dropdown"
                           href="#"
                           role="button"
                           aria-expanded="false">
                           @ViewData["currentCategory"]
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <a class="dropdown-item"
                                   asp-controller="Cosmetics"
                                   asp-route-category=@null>
                                   Все</a>
                            </li>
                            @foreach (var item in ViewBag.Categories)
                            {
                                <li>
                                    <a class="dropdown-item"
                                       asp-controller="Cosmetics"
                                       asp-route-category="@item.NormalizedName">
                                       @item.Name
                                    </a>
                                </li>
                            }
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
        <div class="col-sm-9">
            <div class="row">  
                @foreach (var item in Model.Items) 
                {
                    <div class="col-sm-4">
                        <div class="card h-100 text-center" style="align-items:center">
                            <img src="@item.Image" class="card-img-top" alt="Image of product" width="300" height="300"/>
                            <div class="card-body">
                                <h5 class="card-title"> @Html.DisplayFor(modelItem => item.Name)</h5>
                                <p class="card-text">@Html.DisplayFor(modelItem => item.Description)</p>
                            </div>
                            <a asp-controller="Cosmetics/card/add/@item.Id"
                               asp-route-pageNo="@Model.CurrentPage"
                               asp-route-returnUrl="@returnUrl"
                               class="btn btn-primary mb-3 ms-3">Добавить в корзину <i class="fa-solid fa-cart-shopping"></i></a>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
    <nav aria-label="..." class="mt-4">
        <ul class="pagination justify-content-center">
            <li class="page-item @(Model.CurrentPage == 1 ? "disabled" : "")">
                <a class="page-link" asp-controller="Cosmetics"
                   asp-route-category="@category" asp-route-pageNo="@(Model.CurrentPage - 1)">Previous</a>
            </li>
            @for (var i = 1; i <= Model.TotalPages; ++i)
            {
                <li class="page-item  @(Model.CurrentPage == i ? "active":"")">
                    <a class="page-link" asp-controller="Cosmetics"
                   asp-route-category="@category" asp-route-pageNo="@i">@i</a>
                </li>
            }
            <li class="page-item @(Model.CurrentPage == Model.TotalPages ? "disabled" : "")">
                <a class="page-link" asp-controller="Cosmetics"
                   asp-route-category="@category" asp-route-pageNo="@(Model.CurrentPage + 1)">Next </a>
            </li>
        </ul>
    </nav>
</body>
</html>
